/*
Mathematica Demo for Karacell

Compare to demo.c. The functions in this file are for demonstration purposes, and are not part of the Karacell specification.

You can paste these functions into the Mathematica Kernel interpreter in the order written below, for immediate output.
*/
KARACELL_COMPLEXITY_LOG2_LIST is generated by the following function, which computes the floor of the log2 of the Horowitz & Sahni complexity. Other more recent approaches to Subset Sum are sometimes faster, but apparently not in the case of Karacell:
-------------------------------------------
flclist=Array[#&,((106-2)/2)+1];For[t=2,t<=106,t+=2,flclist[[((t-2)/2)+1]]=Floor[Log[2,Binomial[(2^16),t/2]/Binomial[t,t/2]]]];Print["floor_log2_complexity_list=",flclist];
-------------------------------------------
The following function finds the maximum 0-based tumbler index (tumbleridxmax) required, given a master key (masterkey).
-------------------------------------------
masterkey=16^^D434958528FC60A82CCB6F2E652EAA143B97BF6888D530DF44EBCBC56D56B544491B23FD4EE9B1988B03E2A1E939FE768B19DB57A6996DAA4A3D13CA6E8A30BC;
msb=0;While[(2^(msb+1))<=masterkey,msb++];tumbleridxmin=0;tumbleridxmax=(106-2)/2;While[tumbleridxmin!=tumbleridxmax,tumbleridx=BitShiftRight[tumbleridxmin+tumbleridxmax,1];If[msb<flclist[[tumbleridx+1]],tumbleridxmax=tumbleridx,tumbleridxmin=tumbleridx+1]];tumbleridxmax=(tumbleridxmax*2)+1;Print["tumbler_idx_max=",tumbleridxmax];
-------------------------------------------
Tumbler lists are computed by the following function, given the tumbler bias (tumblerbias), block index (blockidx, 0 being the header, 1 being the first payload block, and N+1 being the lmd8_xor_all footer where N is the last payload block), initial value (iv), and the same masterkey and tumbleridxmax as in the previous function. In reality, tumblerbias would be 0 for cryption or 0x8000 for LMD8 seed evaluation, but it's set to a random value here in order to show how it works. Note that you will see 2 tumbler collisions ("TUMBLER COLLISION").
-------------------------------------------
tumblerbias=16^^AEDB;
blockidx=16^^CA298624A4A8E8D5;
iv=16^^15A497E7ADFABE12242BC3839335FCC5BB89F4B54792D6DA9257D1F9FBE33275;
tumblerlist=Array[#&,tumbleridxmax+1];tumblersused=32;iterand=BitXor[(iv*(2^256)),masterkey];For[bitidx=0,bitidx<=127,bitidx++,If[BitAnd[BitShiftRight[blockidx,bitidx],1]==1,iterand=BitXor[iterand,BitShiftLeft[1,255-bitidx]]]];For[tumbleridx=0,tumbleridx<=tumbleridxmax,tumbleridx++,If[tumblersused==32,tumblersused=0;For[iteration=0,iteration<=9,iteration++,iterand=(((2^256)-16^^E66FAD12)*(BitAnd[iterand,(2^256)-1]))+BitShiftRight[iterand,256]]];tumblerlist[[tumbleridx+1]]=BitAnd[BitShiftRight[iterand,BitShiftLeft[tumblersused,4]],(2^16)-1];For[checkidx=0,checkidx<tumbleridx,checkidx++,If[tumblerlist[[checkidx+1]]==tumblerlist[[tumbleridx+1]],tumbleridx--;Print["TUMBLER COLLISION\n"]]];tumblersused++];Print["tumbler_list=",BaseForm[tumblerlist,16]];
-------------------------------------------
Xor masks are computed by the following function after all the above functions have been run. Just put the maximum 0-based u32 index (0 to 16^^3FF) in masku32idxmax.

You should see:

  xor_mask_lmd2=b7dcacfb939f6b48

just like what demo(.exe) prints out at the end.
-------------------------------------------
masku32idxmax=16^^33A;
karacelltable=16^^89451924FE9B0EE34C679397B9C29DB7A4B4C69C3CB1B8BD22375B3CD41914A9E941EC11DDF65EE2E622D521C5C48A5AA108A1530C6923BFBE9C36946B7158C3411433FDAFDB0C06B34133F69D1436359A3176D65CC75704719E513E12292782FFC8581D1A8990A7448D615763B873A6EC1C22089D639DB091625D945D65B6E8B33E58BE1BE4C01728E23589D22B178E133FB0AB77C48D45ECD27B8EC7971DDA935AC51B1B3FB860DA770C9D6E6C073C9D42C1115A3C7D780C7238F8DD12D1CF017E2A1DBD9015488A18A2689A6138EF474314460E9013700AD807AFA3A698388A25B5C870881928E2D9A2932C349B18ED718E0CC52A428CA78D2D07ACC0980D34B89FE4CC318BCA094E7547D1CAF91C1037D11EC6CB7D7BC9BF8B326CF498564A472CBD968F2771FF51E92FF68F2A54EE00570CAC03D13A70F17F17F475483EFB96AE775793470B0D7B46B262D7AB71314815CF008AE4669758942BFD5D491AE91D831DC2E59C1FFC1182A4DB290B283044FD8979C45FCE3BFD38BDD3AC459789AA53517BCB0E1DCEF95402F08CEA840A6C8D41251404C4B63A99EB63B89FF8108EEC53AFA13688FA079A3778D1F58A2B0F3280B9DD9E22E88EADE063FFCA37043EAA8F44DEC094F7F3715C588C0BBB1A878837123EAC5FC96D4C6D9830BA36480A41326156180CCABFA6762B4924E0A9D561D40DE67D6F50C7CFE483BE329873E0901ACDDFFD0A726DF96F3F1CF33C230CA40D1A4D442AE461E43FACC1B443EA2044CA0664B01E165C3548096DDAA37FA0FAC27857CF35F0396F816C3B035CEE485C6DC97BBE65501B3D4C97D1EC956B96EC0384E22B3167FC97A5EFA89E9DC2DB1F299EFD040AD3F13BC6E5CCF9D73FC1F76AB662D8204FDB9564CE657B9BEB1532E1644C64A25556105F4E71E70C4245BC53257FFC20369F3B3C6A9B759E3736CADCE667F5C655DF3D0F44533E2862AE11444F9502CE81C3326386E5220CF20DEF4407BA2CB196ED9FD2682559DFF93481A06F8D88E8315DAC377A4FB6198ED3AD5E5EDDDB7AF28133E635A6A6BA7F99662DF569607954BC6C636C7D8435D5ADA3815B18148D651F378DBF695A77347F22F31C1F616419D40880896206F2B5758AE987AAD2C345D8C0B3EED33754E84782A59A3D2EDC0C4C5C10AEF59BA1755BD7B0C31032E27EA1623A3BAEB873E228C6773492AB7BA1930BED0DAB2E545250DE6FB1D9920218375B30304D70AC31966F64E504D5318A7A9708760F4F20D4E772599B8C559A431F436170E409A55F6C3FF0704E110EA4DB4AC5720BC3EDDA1D367112FE914B38AA79569719DDC62F62F55C6F774858E7022EA814A6EE53EE1FBEA7C979A5EFF7C28DC2DA987161EB0D188BAB03977D500C8A26A806664DE6401166BEF78FBEA2666FC02B8288857C4B31441209A58BA8A8CDF6062BC98E1198F567D3901B19280B4E2D7BA82C6E88776615C9CC16FC087EF19F58C1BD8D37F911D5A951A2B5DDCE0C397B4AAACAB55EFFA0911FC06004FC8EAB4E40CE0F1C8E12B655BFA0AD593E93905F87D9DF7E760DC7769BCA1EA77A9FD501215DF6E5336A09DF4C17FEDE8FFA6AA597F59BB986BA5D1A2BEAAB675BDCF82575BBDA9E3781C1AF9C47FBA91C76B6C6CE308088852E92E346870AA6344AC673570BAB57625739F0A430590FFDB4D7D93825F3D0D517D44101EFEC23F2A19C10E281B6488A204B72D78AF29A227EBA945837333BA0844D009521FB77E05299BB7887C69D2E3860ADEF6E12A7C10C90DA596FBE984AAEAE89DE51AB5CED01E77DA799BBE9F785FB1479DA1F05C5C64B41368C7D5188EB665F31F353D5537FC2E4078B8CE050CFDA04922C14194D39996B932EE8901EAB192BD08A8B6314E9D62D13215792F9DC946CD269B2D0C8C380DCA0240D9B584ABA67D2B5ACCC72CB5FB4B41E5AA7B916D272D511A84C0AF7D688BE79B111DFAF9FBE016E08C6BD4D9D2CAE49FB5154A8DE0268F754C8646FADBCA8D47A2C7130D1E3908BB9204E249833876844094587D3946D7D4E3074952CA95DD34811482F1A964B89A171B06D9167D440B36D6DE75F4226A87227E64AD9C66ED958FCEC2EEAC8B53DBFF1AFA705DB40673BDDC6FE7EA48AD80336B13A4223B3F3B4A3F1FA20C19C35E2BBDF356D2CF36FB160127395A5C6D2C5AC4EFA698E0391823E0465016FFF33C427BD89E9D4126F131FD52022B0408366F062B4A3CE1492F64C52EFA7CE3CCFD9A86F570A5527B042123D8B05771D9E8CD9C8EF73F05B8E6EC80A17B347F12FBA6EEB2FA8004F1D0E35E6DF8AD84866A11778C5F00153BC48624D5724A16C00A2527C3A95EDEF13EEE399847ACB43ECAED629FB92E4D866671BED52E2CE51C55CF4574B401A8FB22B8B5DA4EAE2D7683E4DD3A0724EF71F3862F95DF348A22F1943381F093B93DE569C45D63F5FCF1C162FC550C4C2D624BB5FB15278D7D0B6BD75312739A9FEBDB4F8C8A9B3551E7FA5EF8CF65649BD72D73F22368B32610EA2F5628F342F259CD3A826705862F22DA0BCD5136BA5FFF31FD7F2C35D175791F08ADD18E37E8F76904F128B3AF1AB65584290A8E312550604897A201C7C49A5F5FF6281F37DCF71222A0533856919E301C666B9C43619EDDDEBAB69C6F7A19EF4CF1F10340C13D959A9EFD3CC05FA03E0DB1D38079225321F4B93742A7255DF9F22F98D0F5ADCB9F73E5D7BE953DB99003BF327D7A119C899E4C7EBDD2F1907444B8A91A741CB75EA1B50040A084584CCEA27E15FD3E74EAA979C839EE4658ABF5172063EE907B9C8AC9EAD1D1B2248DF811EB326E1595BE971D07C06609D01A0DD8D09E548058950152C556D59A32C353321591CC00CB7E6ED8962321052ED936AA7DD4E3FDE7C2C63803ECE8D385513CBAB88B74E488357524EFCD97DC7DF1C72AAE486B3DDF468FFAB9A89DADAD5DD17AE24F47FB9832E20FF0C63E51861B746169F49A8E26D549424C64C80BFBB8EA630B91E1374D86DF11233179DBC84861FCBB85A3F291555B9208CB1E238D65CC9D86630EDA12673D79F53653420F5A874DDABA27EE05B1A62B5B3D5EB9D6B134D003369A2B34FB651259AFABEC7D590DE3C8F4C088459793A40BBD4EBA32F4E3D81FB8A59EA36A8274B1BCFB550B558F70B35A4742E4267C072C9EC496EF41B6D19F595D679896152954BE375F006FA35C844450BC2F350B604AC5DEC413BA80E008F8FB9936E2BF3D03BE50ABF71A02A97F0A5AA483741DE0C1C8D663FBE5139349168F29B48C848AE8BA50E8AD0A1B200139446DBB3AE62D9D2C0CD3D2196C8AEDFF5727D10BB58729B5FFB617172E611139FCCB3E9B11E32FA6604D3CFB3902CE2248B45201CB3CD98329F30DB3B789197AAD0924BF1125BEC9A21E0299A62C4B1BD4AAAEA3D3EBB8B1AA21D430F2389BA64570EF551EE035D3DC642F5D07E76497B67DAD80D79B22EFDCF8151A1D75F180103FD7E777C3464F9B6FFEEAA79DEC07CA512356191AA4E7DBC11B7FF6FAA0D2CBEA2FCDF27B17C61A3BD3F1D210BCEBD2B2D887CE31EC2F60BC4C64C1D78B51EDB0FF9D8AC4AF109329CD5CA52946F7878136FFAF4959D7B1272B2B8282D871605B37CF24D36F44EC2A8D639F91AA2F124EED0BB10404DCF73610D85A537341918F9A0656D20C3E34A1D2433B96BC0F3DC975AE31EEC47DD4E228837EE0F27E0157FA82486E19272CADF0A9872AD7ABD8C34D84DC19A6DA27156D4DA98ADBB82108CE7D37BA290090C2567EC509906B3DDD689487F1E5C6D04D9081B3910CE825FDB6DAC01F853F23C46CBF032A8A6502B5F4ADF75223196D8435DB9BDB26E0960EFCDA73027757739D7D410FF612F13DA1C8C6EF66C143B523671BA92A61444FEEA1F5650BE199BB229267AB0B853DC4FFC47C9B8FA485C2E5A3ACB743275B5614AFF625BF74AD3AA402EE5D1D4EE89CDE7858D0A54044CE30D67B2FEDA8088F3B38D77C5314DDBA2DF09FC220EEC878DB0E9A724622E2978A1326DD7DD2A7C3C81682861347EF1F50EB16534CE07FE49B4B8324EDACEF822A1B3EA442ECEBAD671FA77759C60E548C738278096C3FD0C29255878DCD3C941D26CDA836B98576E7BA88DF4188B940C4BE102B85B7DD00418E91B2923881F484D7A390E04DD375367027E533C5AE489271E419405A50D71F0AE61AFE18B816066B7D8A5B892A32696F697245746D7E624CCA6E0B81029CB7EF5F78DE5A65D15C4CDD5D1467D83553B3629878505BCC228AA4ED4E3ABF9AB50EE411FBA111A6240B7344B3E7AF94253AD30637DD2751E459097B5FE0F98FEEB083DF2CDE88BE29CC2655C94F1A79C21B1B75A29C8A2386DDC8E8F543E08718FBE0E923C8BDF789A9C26E2F8BC9D55D1B2C2B64D93A663647F3A89D8BF4E43363D09567822392CF631D5B05D75A5902971454E32ECFB07F2C9B05D8F8AEE2D1C70617E3E8CFD4BD7890253894FF702AFC99E2DD16BC0F384D60519FA547A614BC0FCA23ACA68E9F66353D74F3BBE4BD33E4C030118D129D5CBCA6CB38C5F73F265A6E1CD7D2BDFCA34B13267AEA127660E0402254BC071713723FDCADAE292EA684E75F4B61686543517BBB9C6372AB37F648FD46E49ED1FC2F855FD26F4BCAD35FA019B041F7E569D6BAABB3E41CB3D99AD10F08AF908C76D14687B2E801B6E431D393C98697214DF98823FC575B24C8CF7DB96BC0F3853AC265421F17AAA4A8C3F3B6C922C1EBDE8399B2DC3F141E5F5F7C254193A464EDA18DECC8E9AF29F5208E385833D96A6591A8A93B822DE8D59014E976A0215C629EDCCAB5A0D2CCD56A768BC7BFDCCC9FA95DF44633C8CB54B8477B1D602E26D7093C72158AEBAED6B6B13CFFD3D2BED7ECC7E6A1F4441BFD06554DB07B88986817B61F0D1D3E8498FFCE46B0D445677E61FBCE8BEE9818E6C97508F5637BA9DC22FF2257E40BF7F4E2E3982C76BBA310A0D71D8E338E2AA56B9AEF901EE98A7C88F2BA4A892CF08176C4EB96D886CBA1C8B7A9C501C07A51F032A6B868F86056982AACE40EEE179B72196262E4EDED474B858451A416323539E1E8E10CE033B384E7BAEF05C7AA8C8BE4440F8C2E24C4702407268E06CCC8B0386BB64BD9DE807C84BF0EAAE9999AD0EB3F7E31EA392320B6CD03C4B4879E2DD008196D20314A1987B48DE03ADEB581AFF68F5A29D28F0F47EE3BC6EAB1804B2102D2B35DAD51DB0A946F0DB9A3D24DDDA3591737DB9D3D2D14B2EF0CB1988823D6620D6BE9819B84364A3EF7878EA9D190712EFC04729CB22A404DCAE70420C1EF8FAE18E3899E6BEE2553AB7EF80E638C423EC68C6ACCEBBAFA69387B8F53A647EEFE06EB8CB0BFC6ADF857B1B7825C7D7A2FED154D20AF731D0675EFDF82ABD0049701AE6A64B8D5DDCD723C037CD19AAB549B9CC5DC79089F5716572F76A27A246E634A02F4807C40914002A7250F39D9183B89B5A2D4BFD3EFC68CC3E30C6EE95DC76F7EDB2102E95DCFE448E4AE91C300E1AD9F088D3620487BDEA027263C4E4F0625D6777488D40E62AD20C8861C64E0BBCBCB7E2B2767ACDFE6E444AE1C417EFB5D04E985F7AED37277BBAA97FD8E41E31E3D9DB358C8FDFD1F5FB2585D578CF8C80643A78132C0B0C3088E2008465DF956D3306E6CDBBFAF1AFD0A86760540B4B3BA069F14A699C4A2A348CDD296F144C75D81706878CD20B010B6D7BF9F0DEBF3A1A26C1C30A77C06B293F53AC8393B59E1C062F37587F89F2D2831BDE19D1E7AE03E6B076C26D4E958A3BF70A829E381F4A99EFBB4DBFBA45ACDB4408C582A391527A59AEDEDC1178D41CFD59F7B9F71E0E115D898C05B53F7B493FF14DCB4774FD32A7E916340CE954ED0D10510E9C0FF67ED237E637483DF23D028976A2B74AA8E0F6A496A4586C9C6DF76F4EE810CDE12FC5C7ECBA3D890128E71C9BEC1A811E7F575708ECAC1C2A3F01FDD0D923192A28BAA16F00FF2B5A3A3FD9DD72C76F1814C89680B89F79B3D7E6276DD21CFDC2BE23F657AD4D4C7D1F31B47F6D74EE0C222D54125365F51C0A685F9A91ABEBF5423051CA752FB00FE90B796535A013AD41F11500B7C09A75D1F9AD5907FCC84E2AA68626337DB66FDACF932F884D54FA4821E3E29B14F8C4D6BB6221B72078B3C02182B8D6485BB90B72927DE4C2BB599DA77D69F8D969A1CE61DCB3F867DB3B44D08ED3316B399B6EB0423F90E7F0A168F6A0433CDB2E73E54F36032F7A79AE2ADDA5B0F83A22AE77E887F6A78183C66CC9B6E38B78688CD54E33A545D9FD655BD3A09A34FF420D7191DC5C304AFE67A00CB177EAF1CE7D1B9FD36F07D92A9DD533254A8FD1A29C3F8FAAB349EF733094C04965D4BF846ABD869CA37E5005D884BF326845136C8608D090D9382B203702698F881AE50345E5522A825F7CD8A78957AEB9FA1BE3BE34147D91FC56D3DEFDE096496A21272F9EBEA5DBA3C302FF28DADD79D2DF9BF80B196C029EB2F3C95CE4C99B2A60BC21F80129DE68CC8A4AA0AC16A60F93B635576910DCDAFF7C58ABDDBF99113E5CC9232BAC8B0FE2028F4AA4CD6DDC4C5DD8B2AB78DDC2DB8FF6184518F5D0F0AE4E459E57D750285B56EFF5E24E5188F99F1AB8245C1F3D2C8ECA5F30941C7DB8F2DFAB670186EE4883CEB44E03992EF86F7820496AE6706C707C2A4D59D1B0A980C88C906D27CC297680F47A75C2ABC907E41CC26F78E346CC56D039D5B47D5E2C3A7608FA0F107E882975DAC12C550D38C88F9E8A95AD5C003F955CDC5FAF2CD137C5C25C16C0573B81735F39CDF056CA33705D591F8E21CD124B470C0129BD3E53884C0C2DCD4FAAA0011CEA08429D9F65B5D170C68C2797A8FAFDBDCD3D0E08DE55BFBF802E46B2920D56B21D9DB42E1530C87D320E0B43F1BE5E99FF625C15B3956530D098ECB0F7FACEA9C7EC354FFE8A6D8A0B61C63E53A38D28F92E0EE17E830311A50B04772D06DEF565FA24A74B44E828B90DD00EFE7DB1DF165B84D8A0B32553C2BA7F90E12F71084B8B2F534FEE269291B58A8291EA2B8B6E05B69C4F71C380503189F5F48DFF2D043151EEF87554D348C0082A593706A31AD2856E0D261C61DA8BD2D7349A704E9744CC3BDEA229D559C9E3CED330E7994EEEF0E258002823F9D93CFFBE61F8C0BF792661F5BE23087E4F1AF4085C0B40CF59010BC99B6C4C322E29279AD1EB1CA2A59345083728486304B9CAE03C646F8E4B7CF62F42E24AB435CAE70A75A3AFF42926BF342D418C028D263A6B66CC3201E72D0E1C594D90437EB905650B958E3A22CC4172869C7DCB57BA1309BC0405C0941BA3193F29CDFEE351FC463006B7D4C026E2A7620C938CE5965DA0763BAEDEA9F1B2AFD2BF7C13CDCE5EBF30DC40756E77C046FC602B33387F75C81B421D9821E525D978DF62937DD8EFA95488EAC4A8D803E68A8CC6BC1E2D07A945380A2B6967C46675447ECF5AB2D202586CF9E91FBF4AF8D4691AA5AA88D51160DCDA86F621481B6B8AACBD7DC3A2DC205717A6189A9ABCE2A6D85E0D7319836FAC26DC7B8577F97D4200EEBA81F59BA8B7CA6729A585267351DF3F5FC294558774E55F914FEEF2CD6A5E89A6E3FDFBF9A2A58FC81A87633991B28589E5B920562785929EABD33B8409FA1ACA50780B23B727D5EB86567D082AE53EC30EC7C7F66A16795F4F1B8006EF336707BFB3CA8915D906B4D8ED22DAAB0A8ECDA1720317757CA25EDB6760E556642756507C75F646C60D7A92DB803A7C1BC399C23FD5CC8BCAC4FFB6FE3FC85BC621C61287130238FBCD0AA4F967EDA1D912B025539B90F127B43CCAD58292B67CD472DF60E8981FCC9219982E3E351EBFD2451D8359A420F94F67C5561F83AE8FDAFF5D6F8F2876844E4817460E7E0D43242BE71C22969A5604EF72879817A0B332F96212B3911A29560028FC1DD14BB2EA356B69D8211ED48DEF6521174FC3D79B84D9D3279292FEAFB30E5A3CE9391E3AE1748E8F595B0C336FD01EC83DD4187E15371FCE8A24036770DC1FEA994CEB9B6F8C61038639D871BF6876CC70C221635882CCF00085F6FDE6DD3AE730306578606BBAD88391C96679B16717052ABDBBD159618265E93B4A6844247B0020FD0A901CA919FC033A3C222D55A817AF3DA9C8F61C80AF5B84A25DDE5E2A3DF3EFE615ECF13EB0422E371FB3A816006E8DDBDB6BAAC9D0758F474033343C19B0914F3DA4C9FFDD20842FA7D13AFAA29B1E32D74A82AFCF2AE43DE4EBF57CAB57A6107E3D2EA2477093B9691700E974146A1AEC181408E64B483383FB03165004A7F36DBDCB204CD4FB6CEA0D676D7DEE8A0AFC4121BE87575D56E26E1BD3814378152A27CB233F754A72FD037FC0679FE183A1CF44CE499571F59F05A5661D804544128BC18D8D8611CC322E4D9A64D6FD75E1039D94D4FA4A0319D3D5777B8C8811BF757A0EDAE4C4556B0706B51D1721A6B72DB65C42805693AF060F695029D90A0DCA0F49AE87DABCC4CE880E7137F89F4B9E5ABD81E7A08F8D98C7B0661E1D331D5339663AA32090DC94EDBB39D82CCDF9AC1ECABF3EBE0B2B7C72898100B4D3D12FC5B6E754EC59119A00EC81A7E0259EB093EA8AF7759EF86CB8CE150F28B905ECE62712FA2EE8DA97042CCF81EC276A4F037F2799A82011D17065820F0DF6F984E7D312DBDEF374B6FD837D4DAC84FCFEF4EB389FB06B3AFC14BE3C51CD188F4F553BC72802712127B7B9D2EAC782048C1A875485B40DC78E335D72B4BE5C0E87D893A9AE09D420BCCEC3B89A1D2F05EC5DA633BCFAFE0A3C113C3D988E16FFD53064EB94C3B6D6FD6EA0C03020B098CE83D792A85F88E667B18B3C11E14B1A61B730B1437B69157A586D2B7BB1076D3F7A723B6A6D49365C2436A5DD8B7B563AC46E924FDBAF0FFC64FA01F839340BACCAC0C51B84BF36D02E0B9A60D2B686B2AC118DBA1F13C422E399AB93233739881E634CCDB2BC2A65890BA4A1837AE43B7E4DEAE3A58BCA5B712B3E863F729799B8AF8888F396D89F333BD2171E801E18C704354382170343E3E0E53ECBCDF020841FB1C9665B36FDDD2CE3723ABF553C80B7479D3A4B260BDF2024F58D3DED2729A6BA05F14E7E4623FFB86CCDF9C31953DF2FD4C0A588F99162F79ABF79915F6AD5602F19E9D35BD7E48405EA694AD3D3BE3B316984195BA8D64E32EB79F674127DB39E29BB35969FA0D526B6AD6DF454C869C5D4B30801BB1C3FA7760746AC37193AFF01145DB817DACA9D6CF8470B6ADCB63413209B367C90B67F74AC53A8FE681C01815AB88A281ED0F40BBF30D63BEC888B533A6EFFEEFBB70A167FC311468A052041B032C5DD13875044D7F3134842B9C43AAD1027EB222A14FDB9DB0329B3A659B20A1EA4FBF4807795E2A8F1A62C16198A13126C30D60C6109C72AE5F2A007278BF192050DD1FA7B97212FD28CFC22EE9C082141D29468926495D2AD7FE5625D8364D8A837994B64F4E330C677737B3FCBEB6040BF3EA895F5432308A2D4CFE312642E030D9EA4589F12BA5695E0E6DF3C12200AB1B9E655529343896EBD8B7753CA5CA023BD90C5121A4B1D35E487B7DDCD8DF850DCBED2D945B4A163CB607F04A93204CD5C63993DCFC6800A3133170D5BE6AF483AF74401283CF1B3F5529B20CDAC2C5EC2F5500244067FADA758E8559F5EECB98032ADB5F2A4CE3264D78FB7203552417D2E8C578CBB60E18402513C10657F8E8C1B148AC857D2A1176D6186FC02128403D7F627183251623901B0B00EB690480114C6992633814E7B8F85F1CD6566BF9425297FFFC41A4037E7E9CBA85BEC6584DCF27B4C32F43FE6848006C2EFE5DE32D5500B9C658F4FE6B6CEF4D366B1B6117681AEE0AA7B4F99E9CEAB61E51570053B404AF33A86C2B0DAF23E9FFF2FFDAF4FEBD1A92D94A09E1480DACDAFC6D97C41FD1046E84DA841F88FE381819991B76C3F4981214615F4E3BD78D6E208DF921229EF2622C79736D52892F82086DA19E599D597A43FEF2BBDE621B934B23C9D4619DAE99DEF7FA9DF419BB5D113F1D9B065E70F9C365CCBE1B6EC711199FC9D43900441F3304485F84950DA814EDFB29E4CBDF9012D33903E0CBF9855B5095B268C129A2139CA3257014144572C280B7F6BE2B9DC6F84E264BB65EB97C347FE1314A59DD558349A81A11DF36E7B8D66AEA020DF651868E6A493FB3D503E9CE1EDB605978D7C70509C572D3CDA6082F402B903C24C0C17F2B64F0AD07F47E3817FD0ABF498C03453CDE79FB8864EC4EB1811300162F497DF31DFCB8669E4DCC8AC46020D5139FE367C8EE7E1A45832E5EACC1C15602187A1E26DEF5208A10FEC73A56118C3CF6790CBB2BC6CD2347F55252156BE5D5B50676FCC6AB282A6760B42C54F77592047EFDC73C0152775785C362C056D46AAE6678C08BFE63869A5DF3C34DF737F4F7098392350CB0100709938E90AF3891F30F317705B6C994F371F8E5F2E14D4F34F87BA1439102C9DB985EF25D05D5FBE4F49277910E41289C6548DF90FEA3A142D545007F561040D367A751B0431460C1FF51239998FB0E61CF853DFC71E05180088850DDBB749C04537549D02066482D738AFF274840A9CF97EFF3F9AE27015800B8FC2C85ACEBE8FBF1F3D94326F68BA3909A2B7649CEDFD6D10C8E8ED7119D2479DE763BA3FB0B6BE3369732D530CB5855E5BD07A2A83D055A11A33C242882977F711C2E4812037D2047DE00FC1D110EEB56B29D3C21E0A7BF1C8F84FD5E85581D0832408C1BC6FC092DA61F365A5C001682212713A179D9652C1FB681824ED07E92BC62AEB70D56C4B89EB807396F8EBB1F88CC16387EFB6476AF7A1E5929B0F9448AA98D8042ED81F75CF840B00F6BC2412157DA7A746E42831CB7E323875BE8E6D4EE0DDF3B226568E60BBD1467CBDD94777685B23615D58011CAF40BDB5D69150AE117D496B961C95A7718E00A67EE3D376265331B393CA7793C47DF139EB208861A808C3B4B2CA0828B6BBBE6E958EEEBC163A5181217EC072C3B6C65CCC3F67CAA6B0CEA377260FBF62BF66100E3BA81B43737D28DDC523DDE69F1A1F7830ED737B7B568B4BA7C38789B21093367BF21081E8142314448508AA2D43871CF4B3A86D7649EE5451A7A473DB4F2CAA5BBED212E2BAF56E2A72F5714D5A519ABB465793813074AE7488ECD84654FA5DF4C4A072D71655FB4A06D4B53DAEBC5A98B029B314C8367FDBCB643AC0808E19D1689855A120ED6CA4CD7894CCF7AB455174B62713B0A87B142F04640AA179824D1439A6170B4422715A93BABEDC26BB4639593362CE820A9BC6C8B6A1DB512798CDBF6123E59B05B930A46D1BA1DE6C8584666C650C15501566E9FA86934D5A827A30B5A5AB5B469518336F6A1E2716F17EFB37BF1416B0F8BDA5D8EDDA7E5DB57734A362F129890DB48B4B0BD02A11ADBB48EBEFC59435EE56788F284740CDC9200E4BEB26F8E980DE5E578B077A68CA6A15548EA83259688E520C7E943D0F602D0DCA0B2E9B0B21645E13362303AF78C1E56A6D18E74BFAAAE22535AB33407C3BBA0542D5E413DB6F20A86E4ECB6130D4845D1021884C98DC117F40117835188FB7C9F20BAF6B;
karacelltable=BitShiftLeft[karacelltable,2^16]+karacelltable;
mask=0;For[tumbleridx=0,tumbleridx<=tumbleridxmax,tumbleridx++,tumbler=BitAnd[tumblerlist[[tumbleridx+1]]+tumblerbias,(2^16)-1];mask+=BitShiftRight[karacelltable,tumbler]];mask=BitAnd[mask,(2^BitShiftLeft[masku32idxmax+1,5])-1];Print["xor_mask=",BaseForm[mask,16]];
lmd2=0;lmd2p=16^^C97A34B3129E5CFA;For[maskidx=0,maskidx<=masku32idxmax,maskidx++,lmd2p=(16^^FE001000*BitAnd[lmd2p,(2^32)-1])+BitShiftRight[lmd2p,32];lmd2+=(BitAnd[BitShiftRight[mask,BitShiftLeft[maskidx,5]],(2^32)-1])*BitAnd[lmd2p,(2^32)-1]];lmd2+=lmd2p;lmd2p=BitAnd[lmd2,(2^64)-1];For[maskidx=0,maskidx<=2,maskidx++,lmd2p=(16^^FE001000*BitAnd[lmd2p,(2^32)-1])+BitShiftRight[lmd2p,32]];lmd2+=lmd2p;lmd2=BitAnd[lmd2,(2^64)-1];Print["xor_mask_lmd2=",BaseForm[lmd2,16]];
-------------------------------------------
